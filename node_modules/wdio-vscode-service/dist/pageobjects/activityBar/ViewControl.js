var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
import { DebugView, SideBarView, ScmView } from '../../index.js';
import { NewScmView } from '../sidebar/scm/NewScmView.js';
import { PageDecorator, ElementWithContextMenu, semverGte } from '../utils.js';
import { ViewControl as ViewControlLocators } from '../../locators/1.73.0.js';
/**
 * Page object representing a view container item in the activity bar
 *
 * ```ts
 * const workbench = await browser.getWorkbench()
 * const viewControls = await workbench.getActivityBar().getViewControls()
 * console.log(await Promise.all(viewControls.map((vc) => vc.getTitle())))
 * // returns: [
 * //    'Explorer',
 * //    'Search',
 * //    'Source Control',
 * //    'Run and Debug',
 * //    'Extensions'
 * // ]
 * ```
 *
 * @category ActivityBar
 */
let ViewControl = class ViewControl extends ElementWithContextMenu {
    constructor(locators, element, bar) {
        super(locators, element, bar.elem);
        this.bar = bar;
        /**
         * @private
         */
        this.locatorKey = 'ViewControl';
    }
    /**
     * Opens the associated view if not already open
     * @returns Promise resolving to SideBarView object representing the opened view
     */
    async openView() {
        const klass = await this.elem.getAttribute(this.locators.attribute);
        if (klass.indexOf(this.locators.klass) < 0) {
            await this.elem.click();
            // eslint-disable-next-line wdio/no-pause
            await browser.pause(500);
        }
        const view = await new SideBarView(this.locatorMap).wait();
        if ((await view.elem.$$(this.locators.scmId)).length > 0) {
            const version = await browser.getVSCodeVersion();
            if ((await browser.getVSCodeChannel()) === 'vscode'
                && semverGte(version, '1.47.0')) {
                return new NewScmView(this.locatorMap).wait();
            }
            return new ScmView(this.locatorMap).wait();
        }
        if ((await view.elem.$$(this.locators.debugId)).length > 0) {
            return new DebugView(this.locatorMap).wait();
        }
        return view;
    }
    /**
     * Closes the associated view if not already closed
     * @returns Promise resolving when the view closes
     */
    async closeView() {
        const klass = await this.elem.getAttribute(this.locators.attribute);
        if (klass.indexOf(this.locators.klass) > -1) {
            await this.elem.click();
        }
    }
    /**
     * Returns the title of the associated view
     * @param includeKeyboardShortcuts if true it includes the keyboard shortcut
     *                                 in the title (e.g. "Source Control (Ctrl+Shift+G)")
     */
    async getTitle(includeKeyboardShortcuts = false) {
        const title = await this.badge$.getAttribute('aria-label');
        if (!includeKeyboardShortcuts) {
            /**
             * first strip out possible pending annotation, e.g.
             * "Source Control (⌃⇧G) - 8 pending
             */
            const [label] = title.split(' - ');
            /**
             * next, strip out possible keyboard shortcuts, e.g.
             * "Source Control (⌃⇧G)
             */
            return label.endsWith(')')
                ? label.split(' ').slice(0, -1).join(' ')
                : label;
        }
        return title;
    }
};
ViewControl = __decorate([
    PageDecorator(ViewControlLocators)
], ViewControl);
export { ViewControl };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVmlld0NvbnRyb2wuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvcGFnZW9iamVjdHMvYWN0aXZpdHlCYXIvVmlld0NvbnRyb2wudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBRUEsT0FBTyxFQUNVLFNBQVMsRUFBRSxXQUFXLEVBQUUsT0FBTyxFQUMvQyxNQUFNLGdCQUFnQixDQUFBO0FBQ3ZCLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQTtBQUV6RCxPQUFPLEVBQ0gsYUFBYSxFQUFrQixzQkFBc0IsRUFBb0IsU0FBUyxFQUNyRixNQUFNLGFBQWEsQ0FBQTtBQUNwQixPQUFPLEVBQUUsV0FBVyxJQUFJLG1CQUFtQixFQUFFLE1BQU0sMEJBQTBCLENBQUE7QUFHN0U7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBaUJHO0FBRUksSUFBTSxXQUFXLEdBQWpCLE1BQU0sV0FBWSxTQUFRLHNCQUFrRDtJQU0vRSxZQUNJLFFBQTBCLEVBQzFCLE9BQXFELEVBQzlDLEdBQWdCO1FBRXZCLEtBQUssQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUYzQixRQUFHLEdBQUgsR0FBRyxDQUFhO1FBUjNCOztXQUVHO1FBQ0ksZUFBVSxHQUFHLGFBQXNCLENBQUE7SUFRMUMsQ0FBQztJQUVEOzs7T0FHRztJQUNILEtBQUssQ0FBQyxRQUFRO1FBQ1YsTUFBTSxLQUFLLEdBQUcsTUFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFBO1FBQ25FLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQ3pDLE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQTtZQUN2Qix5Q0FBeUM7WUFDekMsTUFBTSxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzVCLENBQUM7UUFDRCxNQUFNLElBQUksR0FBRyxNQUFNLElBQUksV0FBVyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtRQUMxRCxJQUFJLENBQUMsTUFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQ3ZELE1BQU0sT0FBTyxHQUFHLE1BQU0sT0FBTyxDQUFDLGdCQUFnQixFQUFFLENBQUE7WUFDaEQsSUFDSSxDQUFDLE1BQU0sT0FBTyxDQUFDLGdCQUFnQixFQUFFLENBQUMsS0FBSyxRQUFRO21CQUM1QyxTQUFTLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxFQUNqQyxDQUFDO2dCQUNDLE9BQU8sSUFBSSxVQUFVLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFBO1lBQ2pELENBQUM7WUFDRCxPQUFPLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtRQUM5QyxDQUFDO1FBQ0QsSUFBSSxDQUFDLE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUN6RCxPQUFPLElBQUksU0FBUyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtRQUNoRCxDQUFDO1FBQ0QsT0FBTyxJQUFJLENBQUE7SUFDZixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLFNBQVM7UUFDWCxNQUFNLEtBQUssR0FBRyxNQUFNLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUE7UUFDbkUsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQztZQUMxQyxNQUFNLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUE7UUFDM0IsQ0FBQztJQUNMLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsS0FBSyxDQUFDLFFBQVEsQ0FBRSx3QkFBd0IsR0FBRyxLQUFLO1FBQzVDLE1BQU0sS0FBSyxHQUFHLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxZQUFZLENBQUMsWUFBWSxDQUFDLENBQUE7UUFDMUQsSUFBSSxDQUFDLHdCQUF3QixFQUFFLENBQUM7WUFDNUI7OztlQUdHO1lBQ0gsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUE7WUFFbEM7OztlQUdHO1lBQ0gsT0FBTyxLQUFLLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQztnQkFDdEIsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7Z0JBQ3pDLENBQUMsQ0FBQyxLQUFLLENBQUE7UUFDZixDQUFDO1FBRUQsT0FBTyxLQUFLLENBQUE7SUFDaEIsQ0FBQztDQUNKLENBQUE7QUE5RVksV0FBVztJQUR2QixhQUFhLENBQUMsbUJBQW1CLENBQUM7R0FDdEIsV0FBVyxDQThFdkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IENoYWluYWJsZVByb21pc2VFbGVtZW50IH0gZnJvbSAnd2ViZHJpdmVyaW8nXG5cbmltcG9ydCB7XG4gICAgQWN0aXZpdHlCYXIsIERlYnVnVmlldywgU2lkZUJhclZpZXcsIFNjbVZpZXdcbn0gZnJvbSAnLi4vLi4vaW5kZXguanMnXG5pbXBvcnQgeyBOZXdTY21WaWV3IH0gZnJvbSAnLi4vc2lkZWJhci9zY20vTmV3U2NtVmlldy5qcydcblxuaW1wb3J0IHtcbiAgICBQYWdlRGVjb3JhdG9yLCBJUGFnZURlY29yYXRvciwgRWxlbWVudFdpdGhDb250ZXh0TWVudSwgVlNDb2RlTG9jYXRvck1hcCwgc2VtdmVyR3RlXG59IGZyb20gJy4uL3V0aWxzLmpzJ1xuaW1wb3J0IHsgVmlld0NvbnRyb2wgYXMgVmlld0NvbnRyb2xMb2NhdG9ycyB9IGZyb20gJy4uLy4uL2xvY2F0b3JzLzEuNzMuMC5qcydcblxuZXhwb3J0IGludGVyZmFjZSBWaWV3Q29udHJvbCBleHRlbmRzIElQYWdlRGVjb3JhdG9yPHR5cGVvZiBWaWV3Q29udHJvbExvY2F0b3JzPiB7IH1cbi8qKlxuICogUGFnZSBvYmplY3QgcmVwcmVzZW50aW5nIGEgdmlldyBjb250YWluZXIgaXRlbSBpbiB0aGUgYWN0aXZpdHkgYmFyXG4gKlxuICogYGBgdHNcbiAqIGNvbnN0IHdvcmtiZW5jaCA9IGF3YWl0IGJyb3dzZXIuZ2V0V29ya2JlbmNoKClcbiAqIGNvbnN0IHZpZXdDb250cm9scyA9IGF3YWl0IHdvcmtiZW5jaC5nZXRBY3Rpdml0eUJhcigpLmdldFZpZXdDb250cm9scygpXG4gKiBjb25zb2xlLmxvZyhhd2FpdCBQcm9taXNlLmFsbCh2aWV3Q29udHJvbHMubWFwKCh2YykgPT4gdmMuZ2V0VGl0bGUoKSkpKVxuICogLy8gcmV0dXJuczogW1xuICogLy8gICAgJ0V4cGxvcmVyJyxcbiAqIC8vICAgICdTZWFyY2gnLFxuICogLy8gICAgJ1NvdXJjZSBDb250cm9sJyxcbiAqIC8vICAgICdSdW4gYW5kIERlYnVnJyxcbiAqIC8vICAgICdFeHRlbnNpb25zJ1xuICogLy8gXVxuICogYGBgXG4gKlxuICogQGNhdGVnb3J5IEFjdGl2aXR5QmFyXG4gKi9cbkBQYWdlRGVjb3JhdG9yKFZpZXdDb250cm9sTG9jYXRvcnMpXG5leHBvcnQgY2xhc3MgVmlld0NvbnRyb2wgZXh0ZW5kcyBFbGVtZW50V2l0aENvbnRleHRNZW51PHR5cGVvZiBWaWV3Q29udHJvbExvY2F0b3JzPiB7XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwdWJsaWMgbG9jYXRvcktleSA9ICdWaWV3Q29udHJvbCcgYXMgY29uc3RcblxuICAgIGNvbnN0cnVjdG9yIChcbiAgICAgICAgbG9jYXRvcnM6IFZTQ29kZUxvY2F0b3JNYXAsXG4gICAgICAgIGVsZW1lbnQ6IENoYWluYWJsZVByb21pc2VFbGVtZW50PFdlYmRyaXZlcklPLkVsZW1lbnQ+LFxuICAgICAgICBwdWJsaWMgYmFyOiBBY3Rpdml0eUJhclxuICAgICkge1xuICAgICAgICBzdXBlcihsb2NhdG9ycywgZWxlbWVudCwgYmFyLmVsZW0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3BlbnMgdGhlIGFzc29jaWF0ZWQgdmlldyBpZiBub3QgYWxyZWFkeSBvcGVuXG4gICAgICogQHJldHVybnMgUHJvbWlzZSByZXNvbHZpbmcgdG8gU2lkZUJhclZpZXcgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgb3BlbmVkIHZpZXdcbiAgICAgKi9cbiAgICBhc3luYyBvcGVuVmlldyAoKTogUHJvbWlzZTxTaWRlQmFyVmlldzxhbnk+IHwgTmV3U2NtVmlldyB8IFNjbVZpZXcgfCBEZWJ1Z1ZpZXc+IHtcbiAgICAgICAgY29uc3Qga2xhc3MgPSBhd2FpdCB0aGlzLmVsZW0uZ2V0QXR0cmlidXRlKHRoaXMubG9jYXRvcnMuYXR0cmlidXRlKVxuICAgICAgICBpZiAoa2xhc3MuaW5kZXhPZih0aGlzLmxvY2F0b3JzLmtsYXNzKSA8IDApIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZWxlbS5jbGljaygpXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgd2Rpby9uby1wYXVzZVxuICAgICAgICAgICAgYXdhaXQgYnJvd3Nlci5wYXVzZSg1MDApXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdmlldyA9IGF3YWl0IG5ldyBTaWRlQmFyVmlldyh0aGlzLmxvY2F0b3JNYXApLndhaXQoKVxuICAgICAgICBpZiAoKGF3YWl0IHZpZXcuZWxlbS4kJCh0aGlzLmxvY2F0b3JzLnNjbUlkKSkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgdmVyc2lvbiA9IGF3YWl0IGJyb3dzZXIuZ2V0VlNDb2RlVmVyc2lvbigpXG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgKGF3YWl0IGJyb3dzZXIuZ2V0VlNDb2RlQ2hhbm5lbCgpKSA9PT0gJ3ZzY29kZSdcbiAgICAgICAgICAgICAgICAmJiBzZW12ZXJHdGUodmVyc2lvbiwgJzEuNDcuMCcpXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE5ld1NjbVZpZXcodGhpcy5sb2NhdG9yTWFwKS53YWl0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgU2NtVmlldyh0aGlzLmxvY2F0b3JNYXApLndhaXQoKVxuICAgICAgICB9XG4gICAgICAgIGlmICgoYXdhaXQgdmlldy5lbGVtLiQkKHRoaXMubG9jYXRvcnMuZGVidWdJZCkpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGVidWdWaWV3KHRoaXMubG9jYXRvck1hcCkud2FpdCgpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZpZXdcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIGFzc29jaWF0ZWQgdmlldyBpZiBub3QgYWxyZWFkeSBjbG9zZWRcbiAgICAgKiBAcmV0dXJucyBQcm9taXNlIHJlc29sdmluZyB3aGVuIHRoZSB2aWV3IGNsb3Nlc1xuICAgICAqL1xuICAgIGFzeW5jIGNsb3NlVmlldyAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGtsYXNzID0gYXdhaXQgdGhpcy5lbGVtLmdldEF0dHJpYnV0ZSh0aGlzLmxvY2F0b3JzLmF0dHJpYnV0ZSlcbiAgICAgICAgaWYgKGtsYXNzLmluZGV4T2YodGhpcy5sb2NhdG9ycy5rbGFzcykgPiAtMSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5lbGVtLmNsaWNrKClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHRpdGxlIG9mIHRoZSBhc3NvY2lhdGVkIHZpZXdcbiAgICAgKiBAcGFyYW0gaW5jbHVkZUtleWJvYXJkU2hvcnRjdXRzIGlmIHRydWUgaXQgaW5jbHVkZXMgdGhlIGtleWJvYXJkIHNob3J0Y3V0XG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbiB0aGUgdGl0bGUgKGUuZy4gXCJTb3VyY2UgQ29udHJvbCAoQ3RybCtTaGlmdCtHKVwiKVxuICAgICAqL1xuICAgIGFzeW5jIGdldFRpdGxlIChpbmNsdWRlS2V5Ym9hcmRTaG9ydGN1dHMgPSBmYWxzZSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHRpdGxlID0gYXdhaXQgdGhpcy5iYWRnZSQuZ2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJylcbiAgICAgICAgaWYgKCFpbmNsdWRlS2V5Ym9hcmRTaG9ydGN1dHMpIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogZmlyc3Qgc3RyaXAgb3V0IHBvc3NpYmxlIHBlbmRpbmcgYW5ub3RhdGlvbiwgZS5nLlxuICAgICAgICAgICAgICogXCJTb3VyY2UgQ29udHJvbCAo4oyD4oenRykgLSA4IHBlbmRpbmdcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3QgW2xhYmVsXSA9IHRpdGxlLnNwbGl0KCcgLSAnKVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIG5leHQsIHN0cmlwIG91dCBwb3NzaWJsZSBrZXlib2FyZCBzaG9ydGN1dHMsIGUuZy5cbiAgICAgICAgICAgICAqIFwiU291cmNlIENvbnRyb2wgKOKMg+KHp0cpXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHJldHVybiBsYWJlbC5lbmRzV2l0aCgnKScpXG4gICAgICAgICAgICAgICAgPyBsYWJlbC5zcGxpdCgnICcpLnNsaWNlKDAsIC0xKS5qb2luKCcgJylcbiAgICAgICAgICAgICAgICA6IGxhYmVsXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGl0bGVcbiAgICB9XG59XG4iXX0=